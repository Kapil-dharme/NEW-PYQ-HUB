<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <%- include("./partials/head") %>

        <title>Add Paper</title>
</head>

<body>
    <%- include("./partials/navbar") %>
    <%- include("./partials/loader") %>
    <%- include("./partials/error") %>
    <%- include("./partials/success") %>

                    <div class="bg-gray-50 font-sans text-gray-800">



                        <div class="container mx-auto px-4 py-10 max-w-3xl">

                            <div class="mb-8 text-center">
                                <div
                                    class="inline-flex items-center justify-center w-16 h-16 rounded-full bg-indigo-100 text-indigo-600 mb-4">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="35" height="35" fill="currentColor"
                                        class="bi bi-file-earmark-plus-fill" viewBox="0 0 16 16">
                                        <path
                                            d="M9.293 0H4a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h8a2 2 0 0 0 2-2V4.707A1 1 0 0 0 13.707 4L10 .293A1 1 0 0 0 9.293 0M9.5 3.5v-2l3 3h-2a1 1 0 0 1-1-1M8.5 7v1.5H10a.5.5 0 0 1 0 1H8.5V11a.5.5 0 0 1-1 0V9.5H6a.5.5 0 0 1 0-1h1.5V7a.5.5 0 0 1 1 0" />
                                    </svg>
                                </div>
                                <h1 class="text-3xl font-bold text-gray-900">Upload New Paper</h1>
                                <p class="text-gray-500 mt-2">Fill in the details below to add a new PYQ to the
                                    database.
                                </p>
                            </div>

                            <div class="bg-white rounded-2xl shadow-xl overflow-hidden border border-gray-100">



                                <form class="p-8 space-y-6" action="/admin/add-paper" method="post"
                                    enctype="multipart/form-data">

                                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                                        <div>
                                            <label class="block text-sm font-semibold text-gray-700 mb-2">Year</label>
                                            <div class="relative group">
                                                <div
                                                    class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">

                                                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16"
                                                        fill="currentColor"
                                                        class="bi bi-mortarboard text-xl text-gray-400 group-focus-within:text-indigo-500 transition-colors"
                                                        viewBox="0 0 16 16">
                                                        <path
                                                            d="M8.211 2.047a.5.5 0 0 0-.422 0l-7.5 3.5a.5.5 0 0 0 .025.917l7.5 3a.5.5 0 0 0 .372 0L14 7.14V13a1 1 0 0 0-1 1v2h3v-2a1 1 0 0 0-1-1V6.739l.686-.275a.5.5 0 0 0 .025-.917zM8 8.46 1.758 5.965 8 3.052l6.242 2.913z" />
                                                        <path
                                                            d="M4.176 9.032a.5.5 0 0 0-.656.327l-.5 1.7a.5.5 0 0 0 .294.605l4.5 1.8a.5.5 0 0 0 .372 0l4.5-1.8a.5.5 0 0 0 .294-.605l-.5-1.7a.5.5 0 0 0-.656-.327L8 10.466zm-.068 1.873.22-.748 3.496 1.311a.5.5 0 0 0 .352 0l3.496-1.311.22.748L8 12.46z" />
                                                    </svg>
                                                </div>
                                                <select required id="yearSelect" name="year"
                                                    onchange="handleYearChange()"
                                                    class="w-full pl-10 pr-10 py-3 bg-gray-50 border border-gray-200 rounded-xl focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 outline-none transition-all appearance-none cursor-pointer">
                                                    <option disabled selected>Select Year</option>
                                                    <option>First Year (FY)</option>
                                                    <option>Second Year (SY)</option>
                                                    <option>Third Year (TY)</option>
                                                    <option>Final Year</option>
                                                </select>
                                                <div
                                                    class="absolute inset-y-0 right-0 flex items-center pr-4 pointer-events-none text-gray-400">
                                                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16"
                                                        fill="currentColor" class="bi bi-chevron-down"
                                                        viewBox="0 0 16 16">
                                                        <path fill-rule="evenodd"
                                                            d="M1.646 4.646a.5.5 0 0 1 .708 0L8 10.293l5.646-5.647a.5.5 0 0 1 .708.708l-6 6a.5.5 0 0 1-.708 0l-6-6a.5.5 0 0 1 0-.708" />
                                                    </svg>
                                                </div>
                                            </div>
                                        </div>

                                        <div>
                                            <label class="block text-sm font-semibold text-gray-700 mb-2">Branch</label>
                                            <div class="relative group" id="branchContainer">
                                                <div
                                                    class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">

                                                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16"
                                                        fill="currentColor"
                                                        class="bi bi-backpack4 text-xl text-gray-400 group-focus-within:text-indigo-500 transition-colors"
                                                        viewBox="0 0 16 16">
                                                        <path
                                                            d="M4 9.5a.5.5 0 0 1 .5-.5h7a.5.5 0 0 1 .5.5v4a.5.5 0 0 1-.5.5h-7a.5.5 0 0 1-.5-.5zm1 .5v3h6v-3h-1v.5a.5.5 0 0 1-1 0V10z" />
                                                        <path
                                                            d="M8 0a2 2 0 0 0-2 2H3.5a2 2 0 0 0-2 2v1c0 .52.198.993.523 1.349A.5.5 0 0 0 2 6.5V14a2 2 0 0 0 2 2h8a2 2 0 0 0 2-2V6.5a.5.5 0 0 0-.023-.151c.325-.356.523-.83.523-1.349V4a2 2 0 0 0-2-2H10a2 2 0 0 0-2-2m0 1a1 1 0 0 0-1 1h2a1 1 0 0 0-1-1M3 14V6.937q.24.062.5.063h4v.5a.5.5 0 0 0 1 0V7h4q.26 0 .5-.063V14a1 1 0 0 1-1 1H4a1 1 0 0 1-1-1m9.5-11a1 1 0 0 1 1 1v1a1 1 0 0 1-1 1h-9a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1z" />
                                                    </svg>
                                                </div>
                                                <select required id="branchSelect" name="branch"
                                                    class="w-full pl-10 pr-10 py-3 bg-gray-50 border border-gray-200 rounded-xl focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 outline-none transition-all appearance-none cursor-pointer">
                                                    <option disabled selected>Select Branch</option>
                                                    <option value="cse">Computer Science & Engineering</option>
                                                    <option value="it">Information Technology</option>
                                                    <option value="entc">Electronics & Telecommunication</option>
                                                    <option value="electrical">Electrical Engineering</option>
                                                    <option value="mechanical">Mechanical Engineering</option>
                                                    <option value="change">Civil Engineering</option>
                                                    <option value="instrumentation">Instrumentation</option>
                                                </select>
                                                <!-- Chevron icon (default) -->
                                                <div id="chevronIcon"
                                                    class="absolute inset-y-0 right-0 flex items-center pr-4 pointer-events-none text-gray-400">
                                                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16"
                                                        fill="currentColor" class="bi bi-chevron-down"
                                                        viewBox="0 0 16 16">
                                                        <path fill-rule="evenodd"
                                                            d="M1.646 4.646a.5.5 0 0 1 .708 0L8 10.293l5.646-5.647a.5.5 0 0 1 .708.708l-6 6a.5.5 0 0 1-.708 0l-6-6a.5.5 0 0 1 0-.708" />
                                                    </svg>
                                                </div>

                                                <!-- Lock icon (hidden by default) -->
                                                <div id="lockIcon"
                                                    class="absolute inset-y-0 right-0 flex items-center pr-4 pointer-events-none text-gray-400 hidden">
                                                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16"
                                                        fill="currentColor" class="bi bi-lock-fill" viewBox="0 0 16 16">
                                                        <path
                                                            d="M8 1a2 2 0 0 1 2 2v4H6V3a2 2 0 0 1 2-2m3 6V3a3 3 0 0 0-6 0v4a2 2 0 0 0-2 2v5a2 2 0 0 0 2 2h6a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2" />
                                                    </svg>
                                                </div>

                                                <div
                                                    class="absolute inset-y-0 right-0 flex items-center pr-4 pointer-events-none text-gray-400">
                                                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16"
                                                        fill="currentColor" class="bi bi-chevron-down"
                                                        viewBox="0 0 16 16">
                                                        <path fill-rule="evenodd"
                                                            d="M1.646 4.646a.5.5 0 0 1 .708 0L8 10.293l5.646-5.647a.5.5 0 0 1 .708.708l-6 6a.5.5 0 0 1-.708 0l-6-6a.5.5 0 0 1 0-.708" />
                                                    </svg>
                                                </div>
                                            </div>
                                        </div>


                                    </div>

                                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                                        <div>
                                            <label class="block text-sm font-semibold text-gray-700 mb-2">Subject
                                                Name</label>
                                            <div class="relative group">
                                                <div
                                                    class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">

                                                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16"
                                                        fill="currentColor"
                                                        class="bi bi-book text-xl text-gray-400 group-focus-within:text-indigo-500 transition-colors"
                                                        viewBox="0 0 16 16">
                                                        <path
                                                            d="M1 2.828c.885-.37 2.154-.769 3.388-.893 1.33-.134 2.458.063 3.112.752v9.746c-.935-.53-2.12-.603-3.213-.493-1.18.12-2.37.461-3.287.811zm7.5-.141c.654-.689 1.782-.886 3.112-.752 1.234.124 2.503.523 3.388.893v9.923c-.918-.35-2.107-.692-3.287-.81-1.094-.111-2.278-.039-3.213.492zM8 1.783C7.015.936 5.587.81 4.287.94c-1.514.153-3.042.672-3.994 1.105A.5.5 0 0 0 0 2.5v11a.5.5 0 0 0 .707.455c.882-.4 2.303-.881 3.68-1.02 1.409-.142 2.59.087 3.223.877a.5.5 0 0 0 .78 0c.633-.79 1.814-1.019 3.222-.877 1.378.139 2.8.62 3.681 1.02A.5.5 0 0 0 16 13.5v-11a.5.5 0 0 0-.293-.455c-.952-.433-2.48-.952-3.994-1.105C10.413.809 8.985.936 8 1.783" />
                                                    </svg>
                                                </div>
                                                <input type="text" placeholder="e.g. Data Structures" required
                                                    autocomplete="off" name="subject"
                                                    class="w-full pl-10 pr-4 py-3 bg-gray-50 border border-gray-200 rounded-xl focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 outline-none transition-all placeholder-gray-400">
                                            </div>
                                        </div>

                                        <div>
                                            <label class="block text-sm font-semibold text-gray-700 mb-2">Exam
                                                Type</label>
                                            <input type="hidden" name="examtype" id="examTypeInput" value="EndSem">
                                            <div class="flex bg-gray-100 p-1 rounded-xl">
                                                <button type="button" onclick="selectType('Ct')" id="btn-Ct"
                                                    class="flex-1 py-2 rounded-lg text-sm font-medium text-gray-600 hover:text-gray-900 transition-all">
                                                    Mid Sem (CT)
                                                </button>
                                                <button type="button" onclick="selectType('EndSem')" id="btn-end"
                                                    class="flex-1 py-2 rounded-lg text-sm font-bold text-indigo-700 bg-white shadow-sm ring-1 ring-black/5 transition-all">
                                                    End Sem
                                                </button>
                                            </div>
                                        </div>
                                    </div>

                                    <div>
                                        <label class="block text-sm font-semibold text-gray-700 mb-2">Upload PDF
                                            File</label>

                                        <label
                                            class="relative flex items-center justify-between w-full p-4 border-2 border-gray-300 border-dashed rounded-xl cursor-pointer bg-gray-50 hover:bg-indigo-50 hover:border-indigo-400 transition-all group">

                                            <div class="flex items-center gap-4">
                                                <div class="p-3 bg-white rounded-lg ">

                                                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20"
                                                        fill="currentColor"
                                                        class="bi bi-filetype-pdf text-2xl text-indigo-500"
                                                        viewBox="0 0 16 16">
                                                        <path fill-rule="evenodd"
                                                            d="M14 4.5V14a2 2 0 0 1-2 2h-1v-1h1a1 1 0 0 0 1-1V4.5h-2A1.5 1.5 0 0 1 9.5 3V1H4a1 1 0 0 0-1 1v9H2V2a2 2 0 0 1 2-2h5.5zM1.6 11.85H0v3.999h.791v-1.342h.803q.43 0 .732-.173.305-.175.463-.474a1.4 1.4 0 0 0 .161-.677q0-.375-.158-.677a1.2 1.2 0 0 0-.46-.477q-.3-.18-.732-.179m.545 1.333a.8.8 0 0 1-.085.38.57.57 0 0 1-.238.241.8.8 0 0 1-.375.082H.788V12.48h.66q.327 0 .512.181.185.183.185.522m1.217-1.333v3.999h1.46q.602 0 .998-.237a1.45 1.45 0 0 0 .595-.689q.196-.45.196-1.084 0-.63-.196-1.075a1.43 1.43 0 0 0-.589-.68q-.396-.234-1.005-.234zm.791.645h.563q.371 0 .609.152a.9.9 0 0 1 .354.454q.118.302.118.753a2.3 2.3 0 0 1-.068.592 1.1 1.1 0 0 1-.196.422.8.8 0 0 1-.334.252 1.3 1.3 0 0 1-.483.082h-.563zm3.743 1.763v1.591h-.79V11.85h2.548v.653H7.896v1.117h1.606v.638z" />
                                                    </svg>
                                                </div>

                                                <div class="text-left">
                                                    <p id="upload-text"
                                                        class="text-sm font-medium text-gray-700 group-hover:text-indigo-700 transition-colors">
                                                        Click to browse file</p>
                                                    <p id="upload-subtext" class="text-xs text-gray-400">PDF up to 10MB
                                                    </p>
                                                </div>
                                            </div>

                                            <span
                                                class="px-4 py-2 text-xs font-bold text-indigo-600 bg-indigo-100 rounded-lg group-hover:bg-indigo-600 group-hover:text-white transition-colors">
                                                Browse
                                            </span>

                                            <input type="file" class="hidden" accept=".pdf" required name="file" />
                                        </label>
                                    </div>

                                    <div class="pt-4">
                                        <button type="submit"
                                            class="w-full bg-gradient-to-r from-indigo-600 to-purple-600 hover:from-indigo-700 hover:to-purple-700 text-white font-bold py-3.5 rounded-xl shadow-lg shadow-indigo-200 transition-all transform hover:-translate-y-0.5 active:translate-y-0 flex justify-center items-center gap-2">
                                            <i class="ph-bold ph-upload-simple"></i>
                                            Upload Paper
                                        </button>
                                    </div>

                                </form>
                            </div>
                        </div>
                    </div>
                    <script>
                        function selectType(type) {
                            const btnCt = document.getElementById('btn-Ct');
                            const btnEnd = document.getElementById('btn-end');
                            const examTypeInput = document.getElementById('examTypeInput');

                            const activeClass = "bg-white shadow-sm ring-1 ring-black/5 text-indigo-700 font-bold";
                            const inactiveClass = "text-gray-600 hover:text-gray-900 font-medium";

                            btnCt.className = `flex-1 py-2 rounded-lg text-sm transition-all ${inactiveClass}`;
                            btnEnd.className = `flex-1 py-2 rounded-lg text-sm transition-all ${inactiveClass}`;

                            if (type === 'Ct') {
                                btnCt.className = `flex-1 py-2 rounded-lg text-sm transition-all ${activeClass}`;
                                examTypeInput.value = 'midsem';  // Set value to 'midsem'
                            } else {
                                btnEnd.className = `flex-1 py-2 rounded-lg text-sm transition-all ${activeClass}`;
                                examTypeInput.value = 'endsem';  // Set value to 'endsem'
                            }
                        }
                    </script>
                    <script>
                        function handleYearChange() {
                            const yearSelect = document.getElementById('yearSelect');
                            const branchSelect = document.getElementById('branchSelect');
                            const chevronIcon = document.getElementById('chevronIcon');
                            const lockIcon = document.getElementById('lockIcon');

                            if (yearSelect.value === 'First Year (FY)') {
                                // Add NA option
                                const naOption = document.createElement('option');
                                naOption.value = 'NA';
                                naOption.textContent = 'N/A';
                                branchSelect.insertBefore(naOption, branchSelect.firstChild.nextSibling);

                                // Set to NA and disable
                                branchSelect.value = 'NA';
                                branchSelect.disabled = true;
                                branchSelect.classList.add('bg-gray-200', 'cursor-not-allowed', 'opacity-60');

                                // Show lock icon, hide chevron
                                chevronIcon.classList.add('hidden');
                                lockIcon.classList.remove('hidden');
                            } else {
                                // Remove NA option if it exists
                                const naOption = branchSelect.querySelector('option[value="NA"]');
                                if (naOption) {
                                    naOption.remove();
                                }
                                branchSelect.selectedIndex = 0;
                                // Enable and reset
                                branchSelect.disabled = false;
                                branchSelect.classList.remove('bg-gray-200', 'cursor-not-allowed', 'opacity-60');
                                branchSelect.value = 'Select Branch';

                                // Show chevron, hide lock icon
                                chevronIcon.classList.remove('hidden');
                                lockIcon.classList.add('hidden');
                            }
                        }

                        // Add form submit handler
                        document.querySelector('form').addEventListener('submit', function (e) {
                            const branchSelect = document.getElementById('branchSelect');

                            // Enable disabled field before submission so value is sent
                            if (branchSelect.disabled) {
                                branchSelect.disabled = false;
                            }
                        });
                    </script>
                    <script>const fileInput = document.querySelector('input[type="file"]');
                        const uploadText = document.getElementById('upload-text');
                        const uploadSubtext = document.getElementById('upload-subtext');

                        fileInput.addEventListener('change', function (e) {
                            const file = e.target.files[0];

                            if (file) {
                                // Format file size
                                const fileSize = formatFileSize(file.size);

                                // Update text to show file name and size
                                uploadText.textContent = file.name;
                                uploadSubtext.textContent = fileSize;
                            }
                        });

                        function formatFileSize(bytes) {
                            if (bytes === 0) return '0 Bytes';
                            const k = 1024;
                            const sizes = ['Bytes', 'KB', 'MB', 'GB'];
                            const i = Math.floor(Math.log(bytes) / Math.log(k));
                            return Math.round(bytes / Math.pow(k, i) * 100) / 100 + ' ' + sizes[i];
                        }</script>
                    <script>
                        document.querySelector('form').addEventListener('submit', function () {
                            showLoader();
                        });
                        window.addEventListener('pageshow', function () {
                            const yearSelect = document.getElementById('yearSelect');
                            if (yearSelect.value && yearSelect.value !== 'Select Year') {
                                handleYearChange();
                            }
                        });
                    </script>
                    <%- include("./partials/footer") %>

</body>

</html>